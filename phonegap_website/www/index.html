<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Deloitte New Zealand </title>

    <link rel=" shortcut icon" href="imgs/favicon.ico">

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/signin.css" rel="stylesheet">
    <link href="css/carousel.css" rel="stylesheet">
    <link href="css/agency.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
          type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- filmStrip -->
    <link rel="stylesheet" href="filmStripSlider/flexslider.css" type="text/css" media="screen" />

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script src="js/agency.js"></script>

    <!-- filmStrip -->

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]>
    <script src="js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.min.js"></script>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/scripts/webServices.js"></script>

    <!--pNotify related links-->
    <script type="application/javascript" src="js/pnotify.custom.min.js"></script>
    <link rel="stylesheet" href="css/pnotify.custom.min.css"/>

    <script src="js/pace.min.js"></script>
    <link href="css/atom.css" rel="stylesheet">



    <script type="application/javascript">
        $(document).ready(function (){

            // Wrapping of default alert
            window.alert = function(message) {
                new PNotify({
                    title: 'Alert',
                    text: message,
                    type: alert_type
                });
            };

            getQuals();
            var saved = window.localStorage.getItem('onlinePortfolioPass');

            if(saved !== null){
                $('#cbRemember').prop('checked', true);
                $('input[name=signin_password]').val(saved);
            }

            $('#frameViewQual').iFrameResize();

            $('#viewQualModal').on('hidden.bs.modal', function () {  //NEED
                $('#frameViewQual').attr('src', '');
            });

            $('#viewQualModal').on('show.bs.modal', function () {
                $('.modal').css('max-width', $(window).width() * 0.94);
                $('.modal').css('max-height', $(window).height() * 0.94);
                $('.modal').css('left', '3%');
                $('.modal').css('right', '3%');
                $('.modal').css('top', '3%');
            });

        });

        function signin(){
            var password = $('input[name=signin_password]').val();

            verifyAccount(password, function() {
                if($('#cbRemember').is(':checked')){
                    window.localStorage.setItem('onlinePortfolioPass',password);
                }
                else{
                    window.localStorage.removeItem('onlinePortfolioPass');
                }


                var account = this;

                if (account != null) {

                    sessionStorage.setItem("account_id", account.accountId);

                    getAccountById(account.accountId, function () {
                        var account = this;
                        if (account.isAdmin == true) {
                            location.replace("homepage.html");
                        } else {
                            location.replace("homepage_client.html");
                        }
                    });
                }

            });
        };

        function viewQual(qual_id){
            console.log(qual_id);
            sessionStorage.setItem("qual_id", qual_id);
            location.href = "#viewQualModal";
            $('#frameViewQual').attr('src', 'view_qual.html');
            getQualById(qual_id, function() {
                $('#client-logo').attr('src', "");
                var qual = this;
                $('#client-logo').attr('src', qual.clientImage);
            });

        }

        function getQuals(){
            getAllPublicQuals(function(){
                var quals = this; //The list of public quals

                var htmlStr="<ul class=\"slides\"> ";


                for (i = 0; i < quals.length; i++) {
                    htmlStr += addPortfolioItem(
                            quals[i].clientImage,quals[i].qualId,
                            '\"addToCart(' + quals[i].qualId+ ", \'" + quals[i].projectName + '\')\"',
                            '\"alert(\'still need to define this one\')\"',
                            quals[i].projectName,
                            false,
                            '\"confirmArchive(\'QUAL\'' + ", \'" + quals[i].qualId + '\')\"'
                    );

//                    htmlStr += addPortfolioItem(
//                            '\"getProjectforClient('+clients[i].accountId+')\"',
//                            '\"\"',
//                            '\"alert(\'still need to define this one\')\"',
//                            clients[i].accountName,
//                            '\"confirmArchive(\'CLIENT\'' + ", \'" + clients[i].accountId + '\')\"',
//                            "",
//                            "",
//                            'client'
//                    );
                }

                htmlStr += "</ul>"
                $("#quals").html(htmlStr)

                //============filmStrip =============

                //Need to do all this AFTER we have loaded the images from webservice!!

                var scroller = $('#scroller div.innerScrollArea');
                var scrollerContent = scroller.children('ul');
                scrollerContent.children().clone().appendTo(scrollerContent);
                var curX = 0;
                scrollerContent.children().each(function(){
                    var $this = $(this);
                    $this.css('left', curX);
                    curX += $this.outerWidth(true);
                });
                var fullW = curX / 2;
                var viewportW = scroller.width();

                // Scrolling speed management
                var controller = {curSpeed:0, fullSpeed:2};
                var $controller = $(controller);
                var tweenToNewSpeed = function(newSpeed, duration)
                {
                    if (duration === undefined)
                        duration = 600;
                    $controller.stop(true).animate({curSpeed:newSpeed}, duration);
                };

                // Pause on hover
                scroller.hover(function(){
                    tweenToNewSpeed(0);
                }, function(){
                    tweenToNewSpeed(controller.fullSpeed);
                });

                // Scrolling management; start the automatical scrolling
                var doScroll = function()
                {
                    var curX = scroller.scrollLeft();
                    var newX = curX + controller.curSpeed;
                    if (newX > fullW*2 - viewportW)
                        newX -= fullW;
                    scroller.scrollLeft(newX);
                };
                setInterval(doScroll, 20);
                tweenToNewSpeed(controller.fullSpeed);


                $('.flexslider').flexslider({
                    animation: "slide",
                    animationLoop: false,
                    itemWidth: 210,
                    itemMargin: 5,
                    minItems: 2,
                    maxItems: 4
                });

                //============filmStrip =============

            });
        }


        //        function addPortfolioItem(viewFunc, addFunc, editFunc, name, archiveFunc, clientImg, projectImg, type){
        //            // var image = isClients ? "\"img/portfolio/roundicons.png\"" : "\"img/portfolio/startup-framework.png\"";
        //
        //            var image = determineItemImage(clientImg, projectImg, type);
        //            var viewFunction = "";
        //            if(isNumeric(viewFunc)) {
        //                viewFunction = ' portfolio-link\' href=\"#viewQualModal\" data-toggle=\"modal\" onclick=\"viewQual(' +viewFunc + ')\"';
        //            }else{
        //                viewFunction = '\' onclick =' +viewFunc + '\"';
        //            }
        //            return "<li><img src=" + image + "><li>"
        //        }

        function addPortfolioItem(image,viewFunc, addFunc, editFunc, name, isClients, archiveFunc){
//            var image = isClients ? "\"img/portfolio/roundicons.png\"" : "\"img/portfolio/startup-framework.png\"";

            var viewFunction = "";
            if(isNumeric(viewFunc)) {
                viewFunction = ' portfolio-link\' href=\"#viewQualModal\" data-toggle=\"modal\" onclick=\"viewQual(' +viewFunc + ')\"';
            }else{
                viewFunction = '\' onclick =' +viewFunc + '\"';
            }
            return "<li><div> \
              <a href='#' class='portfolio-link' data-toggle='modal' > \
                    <img src=" + image + " alt=''> \
              </a> \
        </div>\
        </li>"

//            "<li><img src=" + image + "></li>"

        }

        function determineItemImage(clientImage, projectImage, type){

            var image = ""
            if(type == 'qual'){
                if(projectImage == null){
                    if(clientImage == null){
                        return "img/portfolio/startup-framework.png";
                    }else{
                        return clientImage;
                    }

                }else{
                    return projectImage
                }
            }else if(type == 'client'){
                return "img/portfolio/roundicons.png";
            }else if(type == 'project'){
                return "img/portfolio/startup-framework.png";
            }

        }

        //        function addPortfolioItem(viewFunc, addFunc, editFunc, name, isClients, archiveFunc){
        //            var image = isClients ? "\"img/portfolio/roundicons.png\"" : "\"img/portfolio/startup-framework.png\"";
        //
        //            var viewFunction = "";
        //            if(isNumeric(viewFunc)) {
        //                viewFunction = ' portfolio-link\' href=\"#viewQualModal\" data-toggle=\"modal\" onclick=\"viewQual(' +viewFunc + ')\"';
        //            }else{
        //                viewFunction = '\' onclick =' +viewFunc + '\"';
        //            }
        //            return "<li><img src=" + image + "></li>"
        //        }

        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n);
        }

    </script>

    <style type="text/css">
        .footer {
            position: relative;
            bottom: 0;
            width: 100%;
            height: 30px;
            background-color: #f5f5f5;
        }
    </style>

</head>

<body>


<div id="filmStrip_Container" class="filmstrip-Wrapper">

    <section class="slider">
        <div class="flexslider carousel">
            <div id="scroller">
                <div class="innerScrollArea" id="quals">

                </div>
            </div>
        </div>
    </section>
</div>

<!-- jQuery -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.min.js">\x3C/script>')</script>

<!--FlexSlider-->


<script defer src="filmStripSlider/jquery.flexslider.js">
</script>

<!--filmStrip========================================== -->

<div class="container">
    <div class="jumbotron">
        <h1 align="center">Online Portfolio</h1>
        <p align="center">View any of our public projects above</p>
        <p align="center">Or enter the password you were supplied with to view your private projects</p>
    </div>
</div>

<div class="container">
    <form id="signin_form" action="javascript:signin();" class="form-signin">
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" name="signin_password" class="form-control" placeholder="Password" required autofocus>
        <div class="checkbox">
            <label>
                <input type="checkbox" id="cbRemember" value="remember-me"> Remember me
            </label>
        </div>
        <button class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button>
    </form>
</div>
<!-- /container -->
<footer class="footer" >
    <div class="container">
        <p>&copy; 2015 Deloitte New Zealand &middot; <a href="#">Privacy</a> &middot; <a href="#">Terms</a></p>
    </div>
</footer>


<!-- Modal For View Qual page -->
<div class="portfolio-modal modal fade" id="viewQualModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-content">
        <div class="logo-modal"><img class="logo-image" src="" id="client-logo"></div>
        <div class="close-modal" data-dismiss="modal">
            <div class="lr">
                <div class="rl">
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="modal-body" id="modal_body">
                        <iframe id="frameViewQual" src="" width="100%" scrolling="no" frameborder="0"></iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>
</body>


</html>