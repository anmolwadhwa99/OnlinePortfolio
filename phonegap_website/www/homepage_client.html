<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <script>
        var account = sessionStorage.getItem("account_id");
        if(! account){ // if not defined (i.e. value is undefined or null)
            alert("Please login to access");
            location.replace("index.html");
        }else{
            var isAdmin = sessionStorage.getItem("isAdmin");
            if( isAdmin == "true"){ // if not defined or false
                alert("Sorry you do not have access to this page");
                location.replace("homepage.html");
            }
        }
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Deloitte New Zealand </title>
    <link rel=" shortcut icon" href="imgs/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="js/Fullscreen-Loading-Indicators-with-jQuery-CSS3-HoldOn-js/src/css/HoldOn.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/agency.css" rel="stylesheet">
    <link href="css/select2.min.css" rel="stylesheet">
    <link href="css/modal.css" rel="stylesheet">


    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
          type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/scripts/webServices.js"></script>
    <script src="js/select2.min.js"></script>
    <script src="js/scripts/homepage.js"></script>

    <script type="application/javascript" src="js/raphael-min.js"></script>
    <script type="application/javascript" src="js/colorwheel.js"></script>


    <script type="text/javascript" src="js/jquery.autocomplete.min.js"></script>

    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <script src="js/iframeResizer.min.js"></script>

    <!--pNotify related links-->
    <script type="application/javascript" src="js/pnotify.custom.min.js"></script>
    <link rel="stylesheet" href="css/pnotify.custom.min.css"/>

    <!-- Pace library -->
    <!--<script src="js/pace.min.js"></script>-->
    <!--<link href="css/atom.css" rel="stylesheet" />-->

    <script type="application/javascript">
        $(document).ready(function () {

            HoldOn.open();

            $('#frameQualAdd').iFrameResize();
            $('#frameCreateProj').iFrameResize();
            $('#frameCreateClient').iFrameResize();
            $('#frameViewQual').iFrameResize();

            // Event handling for when the modal's are closed the iframes are unloaded,
            // TODO Add loading of iframe src's to relevant openModal functions
            // E.g. $('#frameViewQual').attr('src', 'view_qual.html');
            $('#addQualModal').on('hidden.bs.modal', function () {
                $('#frameQualAdd').attr('src', '');
            });

            $('#createProjModal').on('hidden.bs.modal', function () {
                $('#frameCreateProj').attr('src', '');
            });

            $('#createClientModal').on('hidden.bs.modal', function () {
                $('#frameCreateClient').attr('src', '');
            });

            $('#viewQualModal').on('hidden.bs.modal', function () {  //NEED
                $('#frameViewQual').attr('src', '');
                $('#client-logo').attr('src', '');
                $('#qual-projectName').text('');
            });
            

        });

        setTimeout(function(){
            HoldOn.close();
        },2000);

    </script>

</head>

<body id="page-top" class="index">
<!-- Navigation -->

<nav>
    <ul class="list-unstyled main-menu" id="ProjectCart">
        <li>
            <button type='submit' class='btn btn-lg' data-toggle="modal" data-target="#createProjModal">Create Project
            </button>
            <a class="pull-right" href="#" id="nav-close"></a>
        </li>
    </ul>
</nav>

<div class="navbar navbar-inverse navbar-fixed-top">

    <div class="container-fluid">

        <div>
            <ul id="visibleNew" class="nav navbar-nav navbar-right">
                <li id="space" style="width: 0em"></li>
            </ul>
        </div>

        <div class="col-sm-5 spec_vertical_center" style="padding-left: 36px;">
            <div  class="input-group stylish-input-group">
                <input id="searchBox" type="text" class="form-control"  placeholder="Search..." onkeyup="search()" >
                    <span id="searchIcon" class="input-group-addon" style="font-size:13px">
                        <button type="button">
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                    </span>
            </div>
            <ul class="nav navbar-nav">
                <li id="resultLI" class="dropdown active">
                    <ul id="resultUL" class="dropdown-menu" style="width:695px; ">

                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>

<script>

    var htmlClientProject = "";
    var qualsToAdd = [];
    var projGroupID = -1;
    var projName = "";

    $(document).ready(function(){

        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var target = $(e.target).attr("href"); // activated tab
            loadTab(target);
        });

        var account_id = sessionStorage.getItem("account_id");
        getAccountById(account_id, function() {

            //dynamic rendering of client UI
            var account = this;
            var primary = account.primaryColour;
            var secondary = account.secondaryColour;

            $(".navbar-inverse").css({
                "background-color":primary.toString(),
                "border-color":secondary.toString()
            });

            $("body").css({
                "color":primary.toString()
            });

            var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = '.nav-tabs > li.active > a, .nav-tabs > li > a:hover { color:'+primary.toString() +' !important; border: none; background: transparent; } ' +
            '.nav-tabs > li > a::after { background:'+primary.toString() + ' !important; content: ""; height: 2px; position: absolute; width: 100%; left: 0px; bottom: -1px; transition: all 250ms ease 0s; transform: scale(0); } ' +
            '.navbar-inverse .navbar-nav>li>a { color:'+secondary.toString() +'}';
            document.getElementsByTagName('head')[0].appendChild(style);

            var vnSpace =  $('#space');

            str = '\
            <li><h7 style="color: '+secondary.toString()+';margin: 0; line-height: 50px">Welcome, '+account.accountName+'!</h7></li>\
            <li><a href="index.html" onclick="javascript: sessionStorage.clear();">Logout <span class="glyphicon glyphicon-log-out"></span></a></li>\
            ';

            vnSpace.before(str);
        });

        getProjects(account_id);
        getEverything();

        $(window).on('shown.bs.modal', function() {

            getAllClients(function () {
                var clients = this;
                var htmlStr = "";
                for(i = 0; i < clients.length; i++) {
                    htmlStr += "<option value='" + clients[i].accountId + "'>" + clients[i].accountName + "</option>";
                }

                var res = $.map(clients, function (item) {
                    return {
                        id: item.accountId,
                        text: item.accountName
                    };
                })

                $("#clientDropdown").select2({data: res});
            });

        });

        //Navigation Menu Slider
        $('#nav-expander').on('click',function(e){
            e.preventDefault();
            $('body').toggleClass('nav-expanded');
        });
        $('#nav-close').on('click',function(e){
            e.preventDefault();
            $('body').removeClass('nav-expanded');
        });

    });


</script>

<section id="portfolio" class="bg-light-gray" style="padding: 0px; padding-top: 22px">
    <div class="container" style="margin: 0px; padding: 0px; width: inherit;">
        <!-- Services Section -->
        <div class="row">
            <div class="col-md-12">
            </div>
        </div>
        <div class="row">

            <div class="col-md-12" style="margin-bottom: 30px;">

                <!-- Nav tabs --><div>
                <ul class="nav nav-tabs nav-justified" role="tablist" id="tablist">
                    <li role="presentation"><a href="#quals"  aria-controls="quals" role="tab" data-toggle="tab">Quals</a></li>
                    <li role="presentation" class="active" ><a href="#projects" aria-controls="projects" role="tab" data-toggle="tab">Projects</a></li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="projects"></div>
                    <div role="tabpanel" class="tab-pane" id="quals"></div>
                </div>

            </div>
            </div>

        </div></div></section>

<footer></footer>

<!-- Modal For View Qual page -->
<div class="portfolio-modal modal fade" id="viewQualModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl" role="document" style= "position: fixed;">
        <div class="modal-content">
            <div class="modal-header">
                <div id='client-logo'class="logo-modal portfolio-image ">
                </div>
                <h3 id="qual-projectName" class="viewQual-modalHeader"></h3>
                <div id="viewButtons" class="close-modal">
                    <i class="fa fa-times fa-5x" data-dismiss="modal" onclick="clearModalPic()"></i>
                </div>
            </div>
            <div class="modal-body" id="modal_body">
                <iframe id="frameViewQual" src="" width="100%" scrolling="no" frameborder="0"></iframe>
            </div>
        </div>
    </div>
</div>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="js/classie.js"></script>
    <script src="js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="js/agency.js"></script>

</body>
<script src="js/Fullscreen-Loading-Indicators-with-jQuery-CSS3-HoldOn-js/src/js/HoldOn.min.js"></script>
</html>
